From 3e377d3f352db86eb48c14c16446d68e80d95f62 Mon Sep 17 00:00:00 2001
From: ntewolde <ntewolde@codeaurora.org>
Date: Fri, 14 Aug 2015 02:39:18 -0700
Subject: [PATCH 16/16] camera hall enable meta mode for buffer sharing

---
 libcamera/inc/camera_parameters.h | 3 +++
 libcamera/src/qcamera2.cpp        | 3 +++
 2 files changed, 6 insertions(+)

diff --git a/libcamera/inc/camera_parameters.h b/libcamera/inc/camera_parameters.h
index a994039..345e43d 100644
--- a/libcamera/inc/camera_parameters.h
+++ b/libcamera/inc/camera_parameters.h
@@ -58,6 +58,9 @@ struct Range
     int min;    /*!< minimum value */
     int max;    /*!< maximum value */
     int step;   /*!< step increment for intermediate values */
+
+    Range() : min(0), max(0), step(0) {}
+    Range(int m, int x, int s) : min(m), max(x), step(s) {}
 };
 
 /**
diff --git a/libcamera/src/qcamera2.cpp b/libcamera/src/qcamera2.cpp
index a5ade51..0529037 100644
--- a/libcamera/src/qcamera2.cpp
+++ b/libcamera/src/qcamera2.cpp
@@ -166,6 +166,7 @@ public:
               break;
           case CAMERA_MSG_VIDEO_FRAME:
               type = CAMERA_FRAME_VIDEO;
+              break;
           default:
               CAM_ERR("unsupported msg type, msg=%d", msg_type);
         }
@@ -303,6 +304,8 @@ int QCamera2::init(int idx)
         goto bail;
     }
 
+    dev_->ops->store_meta_data_in_buffers(dev_,1);
+
     dev_->ops->set_callbacks(dev_, QCamera2::notify_callback,
                              QCamera2::data_callback,
                              QCamera2::data_timestamp_callback,
-- 
1.9.1

