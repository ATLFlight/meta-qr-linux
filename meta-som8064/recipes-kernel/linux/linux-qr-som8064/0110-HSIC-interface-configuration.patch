From 601c144f52dfde1a3b9eef1e56f0a5f8703ba372 Mon Sep 17 00:00:00 2001
From: Kaustubh Gondkar <kgondkar@codeaurora.org>
Date: Thu, 20 Feb 2014 10:44:33 -0800
Subject: [PATCH] HSIC interface configuration

---
 arch/arm/mach-msm/board-8064.c   | 9 +++++++++
 arch/arm/mach-msm/devices-8064.c | 2 ++
 2 files changed, 11 insertions(+)

diff --git a/arch/arm/mach-msm/board-8064.c b/arch/arm/mach-msm/board-8064.c
index 627f0db..046745b 100644
--- a/arch/arm/mach-msm/board-8064.c
+++ b/arch/arm/mach-msm/board-8064.c
@@ -3337,6 +3337,15 @@ static void __init apq8064_common_init(void)
 
 	msm_hsic_pdata.swfi_latency =
 		msm_rpmrs_levels[0].latency_us;
+	if (machine_is_apq8064_som()) {
+		apq8064_device_hsic_host.dev.platform_data = &msm_hsic_pdata;
+		/* Enable hsic host interface, though peripheral device is 
+		   not connected to it. Hence platform_device_register 
+		   is invoked, instead of device_initialize routine.
+		*/
+		/*device_initialize(&apq8064_device_hsic_host.dev);*/
+		platform_device_register(&apq8064_device_hsic_host);
+	}
 	if (machine_is_apq8064_mtp()) {
 		msm_hsic_pdata.log2_irq_thresh = 5,
 		apq8064_device_hsic_host.dev.platform_data = &msm_hsic_pdata;
diff --git a/arch/arm/mach-msm/devices-8064.c b/arch/arm/mach-msm/devices-8064.c
index 358663e..e410d65 100644
--- a/arch/arm/mach-msm/devices-8064.c
+++ b/arch/arm/mach-msm/devices-8064.c
@@ -1143,6 +1143,7 @@ static struct resource resources_hsic_host[] = {
 		.end	= USB2_HSIC_IRQ,
 		.flags	= IORESOURCE_IRQ,
 	},
+#ifndef CONFIG_MACH_APQ8064_SOM
 	{
 		.start	= MSM_GPIO_TO_INT(49),
 		.end	= MSM_GPIO_TO_INT(49),
@@ -1155,6 +1156,7 @@ static struct resource resources_hsic_host[] = {
 		.name	= "wakeup",
 		.flags	= IORESOURCE_IO,
 	},
+#endif
 };
 
 static u64 dma_mask = DMA_BIT_MASK(32);
-- 
1.8.2.1

