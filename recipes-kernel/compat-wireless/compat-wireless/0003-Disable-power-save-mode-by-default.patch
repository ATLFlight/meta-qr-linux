From c32bee6f263639538ea457808146e553d917f357 Mon Sep 17 00:00:00 2001
From: Gustavo Solaira <gustavos@codeaurora.org>
Date: Thu, 18 Jun 2015 18:54:14 -0700
Subject: [PATCH 3/3] Disable power save mode by default

---
 Kbuild                                     | 2 ++
 drivers/net/wireless/ath/ath6kl-3.5/init.c | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/Kbuild b/Kbuild
index b7b5042..8907a3b 100644
--- a/Kbuild
+++ b/Kbuild
@@ -72,3 +72,5 @@ ccflags-y += -DCONFIG_ATH6KL_DEBUG
 ccflags-y += -DCONFIG_ATH6KL_REGDOMAIN
 ccflags-y += -D__CHECK_ENDIAN__
 endif
+
+ccflags-y += -DDISABLE_POWER_SAVE
diff --git a/drivers/net/wireless/ath/ath6kl-3.5/init.c b/drivers/net/wireless/ath/ath6kl-3.5/init.c
index 8476171..fc27726 100644
--- a/drivers/net/wireless/ath/ath6kl-3.5/init.c
+++ b/drivers/net/wireless/ath/ath6kl-3.5/init.c
@@ -3262,7 +3262,7 @@ int ath6kl_core_init(struct ath6kl *ar)
 		}
 	}
 
-#ifdef CE_SUPPORT
+#if defined(CE_SUPPORT) || defined(DISABLE_POWER_SAVE)
 	/* set power saving off as default for wlan0
 	 * (target side default is PS on)
 	*/
-- 
2.4.2

